## План внедрения автоматизированного тестирования формы покупки тура.
### Перечень автоматизируемых сценариев.
Все сценарии можно разделить на две основные ветки: 
- Покупка. В форму вводятся данные карты.
- Получение кредита. Также вводятся данные карты. Поля идентичны, как и в первом случае.

Также автоматизируются API тесты.
### Позитивные сценарии.
#### Покупка.
1. Вариант с валидной картой. Покупка должна быть одобрена банком.
- С главной страницы по кнопке **"купить"** переходим к форме заполнения.
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры. 
Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
Номер карты: 1111 2222 3333 4444. 
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"операция одобрена банком"*.
В БД внесены данные об одобрении операции: в таблицу *order_entity* в поле *payment_id* записывается ID операции, в таблицу
payment_entity в поле *status* заносится значение "APPROVED" в поле transaction_id - тот же ID, что и в таблицу *order_entity*.
#### Кредит
2. Вариант с валидной картой (покупка должна быть одобрена банком).
- С главной страницы по кнопке **"купить в кредит"** переходим к форме заполнения.
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
  Номер карты: 1111 2222 3333 4444.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"операция одобрена банком"*,
  В БД внесены данные об одобрении операции: в таблицу *order_entity* в поле *credit_id* записывается ID операции, в таблицу
  *credit_request_entity* в поле *status* заносится значение "APPROVED" в поле *bank_id* -тот же ID, что и в таблицу *order_entity*.
#### Негативные сценарии
#### Кредит
3. Вариант с невалидной картой (покупка должна быть отклонена банком).
- С главной страницы по кнопке **"купить в кредит"** переходим к форме заполнения.
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
  Номер карты: 5555 6666 7777 8888.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*,
  В БД внесены данные об одобрении операции: в таблицу *order_entity* в поле *credit_id* записывается ID операции, в таблицу
  *credit_request_entity* в поле *status* заносится значение "DECLINED" в поле *bank_id* -тот же ID, что и в таблицу *order_entity*.
#### Покупка
Так как поля формы для вариантов "покупка" и "кредит" одни и те же и при заполнении идентичными значениями поведение системы 
предполагается аналогичное, то далее все негативные сценарии подразумевают тестирование только формы "покупка".
Далее первый пункт перехода с главной страницы по кнопке **"купить"** для всех сценариев одинаковый.
4. Вариант с невалидной картой (покупка должна быть отклонена банком).
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
Номер карты: 5555 6666 7777 8888.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*,
  В БД внесены данные об отказе в операции: в таблицу *order_entity* в поле *payment_id* записывается ID операции, в таблицу
  payment_entity в поле *status* заносится значение "DECLINED" в поле transaction_id -тот же ID, что и в таблицу *order_entity*.
5. Номер карты с полным номером - 16 цифр, но невалидная с точки зрения банка. Покупка должна быть отклонена банком.
- Входные данные генерируются при помощи библиотеки Faker, в том числе и номер карты.
 Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
 Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Нет сообщений об ошибках в полях, получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*.
#### Тестирование полей на ввод невалидных значений
6. Все поля формы пустые - не заполнены.
- Поля формы не заполняются.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Под каждым полем появляется сообщение "Поле обязательно для заполнения".
7. Невалидный формат номера карты - одна цифра "0". Валидный формат значения должен быть 16 цифр.
- В поле "номер карты" вводится "0". 
- Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "номер карты".
8. Невалидный формат месяца - значение "00". Валидный формат значения должен быть от 01-12 (двузначный).
- В поле "месяц" вводится значение "00". 
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "месяц".
9. Невалидный формат месяца - значение "13". Валидный формат значения должен быть от 01-12 (двузначный).
- В поле "месяц" вводится значение "13". 
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "месяц".
10. Невалидный формат месяца - значение "1". Валидный формат значения должен быть от 01-12 (двузначный).
- В поле "месяц" вводится значение "1". 
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "месяц".
11. Невалидный формат года - значение "1". Валидный формат значения должен быть не более 5 лет с текущей даты (двузначный).
- В поле "месяц" вводится значение "1".
- Остальные входные данные кроме месяца генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "месяц".
12. Невалидный формат года - значение "30". 
- В поле "год" вводится значение "30". Валидный формат значения должен быть не более 5 лет с текущей даты (двузначный).
- Остальные входные данные кроме года генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Месяц - номер месяца состоит из двух цифр.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "год".
13. Невалидный формат года - значение "00". 
- В поле "год" вводится значение "00". Валидный формат значения должен быть не более 5 лет с текущей даты (двузначный).
- Остальные входные данные кроме года генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
  Месяц - номер месяца состоит из двух цифр.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "год".
14. Поля месяц и год заполняются значениями с прошедшей датой. Год указывается текущий (важно!), а месяц - любой из предыдущего.
  Например, если текущая дата месяц-год 09/22, вводимое значение, например 07/22.
- Вводимые значения месяц и год генерируются при помощи библиотеки Faker с учетом условия выше.
- Остальные входные данные генерируются при помощи библиотеки Faker.
  Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверно указан срок действия карты" под полем "месяц".
15. Невалидный формат значения в поле "Владелец" - цифры. Валидное значение - имя двусоставное владельца (last name, first name) на латинице.
- В поле "владелец" вводится любые три цифры (генерируется Faker)
- Остальные входные данные генерируются при помощи библиотеки Faker. CVV код - 3 цифры.
  Месяц - номер месяца состоит из двух цифр.  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
16. Невалидный формат значения в поле "Владелец" - имя на кириллице. Валидное значение - имя владельца двусоставное(last name, first name) на латинице.
- В поле "владелец" вводится любое имя на кириллице (генерируется Faker).
- Остальные входные данные генерируются при помощи библиотеки Faker. CVV код - 3 цифры.
  Месяц - номер месяца состоит из двух цифр.  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить". 
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
17. Невалидный формат значения в поле "Владелец" - состоит из одного имени. Валидное значение - имя владельца двусоставное (last name, first name) на латинице.
- В поле "владелец" вводится любое first name (генерируется Faker).
- Остальные входные данные генерируются при помощи библиотеки Faker. CVV код - 3 цифры.
  Месяц - номер месяца состоит из двух цифр.  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
18. Невалидный формат значения в поле "Владелец" - содержит спецсимволы. Валидное значение - имя владельца двусоставное (last name, first name) на латинице.
- В поле "владелец" вводится значение состоящее из валидного имени (генерируется Faker)с добавлением спецсимвола вначале.
- Остальные входные данные генерируются при помощи библиотеки Faker. CVV код - 3 цифры.
  Месяц - номер месяца состоит из двух цифр.  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "владелец".
19.  Невалидный формат значения в поле "Код" - содержит одну цифру. Валидное значение - три цифры.
- В поле "СVC/СVV" вводится значение состоящее из одной цифры.
- Остальные входные данные генерируются при помощи библиотеки Faker. Имя владельца составное (first name, last name), локализация для имени владельца"EN").
  Месяц - номер месяца состоит из двух цифр.  Год окончания действия карты - не более 5 лет с текущей даты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Сообщение "неверный формат" под полем "СVC/СVV".
20. Сценарий проверки сообщений о некорректных значениях под полями. Сообщения должны пропадать после ввода валидных значений.
- Во все поля формы вводится *невалидное* значение состоящее из одной цифры.
- Форма отправляется по кнопке "продолжить".
- Под каждым полем появляется сообщение "неверный формат"
- Во все поля формы вводится *валидные* значения.
Данные генерируются при помощи библиотеки Faker, в том числе и номер карты.
- Форма отправляется по кнопке "продолжить".
- Ожидаемый результат: Нет сообщений об ошибках в полях. Получено всплывающее сообщение *"Ошибка. Банк отказал в проведении операции"*.
#### Тестирование API.
#### Покупка
Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
Номер карты: 1111 2222 3333 4444.
21. Отправка POST запроса c валидными данными. Покупка должна быть одобрена. 
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/pay
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции ""APPROVED".
#### Кредит
22.  Отправка POST запроса c валидными данными. Покупка должна быть одобрена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/credit
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции ""APPROVED".
#### Негативный сценарий
Входные данные кроме номера карты генерируются при помощи библиотеки Faker.
Имя владельца составное (first name, last name), локализация для имени владельца"EN"). CVV код - 3 цифры.
Год окончания действия карты - не более 5 лет с текущей даты. Месяц - номер месяца состоит из двух цифр.
Номер карты: 5555 6666 7777 8888.
#### Покупка
23. Отправка POST запроса валидными данными. Покупка должна быть отклонена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/pay
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции "DECLINED".
#### Кредит
24. Отправка POST запроса валидными данными. Операция должна быть отклонена.
- Отправка POST запроса с валидными данными в формате JSON на адрес http://localhost:8080//api/v1/credit
- Ожидаемый результат: "StatusCode" ответа "200", "status" операции DECLINED"

#### Перечень используемых инструментов
- JDK 11. Код тестов на  Java.
- IntelliJ IDEA. Среда подготовки авто-тестов.
- JUnit Jupiter. Фреймворк для тестирования.
- Gradle. Система сборки кода.
- Selenide. Продвинутый плагин для тестирования веб-интерфейса.
- Lombok. Плагин для минимизации строк кода за счет аннотаций.
- Faker.  Плагин для генерации данных.
- Github. Как репозиторий для хранения кода.
- Gradle. Инструмент для создания простых отчетов и анализа результатов авто-тестов.

### Перечень и описание возможных рисков при автоматизации
- Отсутсвие требований к полям формы.
- Отсутсвие спецификации к БД с инф. по таблицам, полям и значениям.
- Отсутсвие спецификации по запросам REST API. 

### Интервальная оценка с учётом рисков (в часах)
Ориентировочно оценка внедрения автоматизации - 40 часов.

### План сдачи работ 
- автотесты - 06.08.2022
- результаты прогона -  07.08.22
- отчёт по автоматизации - 09.02.22
